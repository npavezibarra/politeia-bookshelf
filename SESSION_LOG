Sessions:

December 31st, 11:43 UTC
1. Created SESSION_LOG to begin tracking plugin work sessions.
2. Documented initial log structure for future updates.

December 31st, 2025, 14:09 UTC
1. Added AGENTS.md to plugin root with master goal and Phase 0 ground rules.
2. Identified canonical write entry points for books/authors/pivot tables (single-add and confirm flows).
3. Added a canonical write guard: single-add uses source='candidate' (no inserts), confirm flow uses source='confirmed' (allowed).

December 31st, 2025, 15:03 UTC
1. Added prs_create_book_candidate to create suggestion-only candidates and optionally enqueue them.
2. Normalized candidate ingestion and stored original input + external metadata + raw payloads in queue rows.
3. Refactored single-add flow to use candidate creation + immediate confirmation, and added a pre-check to link existing canonical books before queuing.

December 31st, 2025, 15:27 UTC
1. Centralized canonical promotion via prs_promote_candidate_to_canonical and routed confirm flow through it.
2. Added canonical re-checks in promotion and ensured author/pivot sync happens only at promotion time.
3. Made promotion idempotent by reusing existing book/user-book records when present.

December 31st, 2025, 15:38 UTC
1. Deprecated canonical author columns for new writes (legacy fields left blank).
2. Shifted canonical lookups to prefer slug and use title_author_hash as a safety net only.

December 31st, 2025, 20:43 UTC
1. Phase 6 diagnostics executed via temporary admin-only hook.
2. Canonical integrity and collision checks completed; hash removal gate evaluated.
3. Hash is currently required. (Update with exact counts in this entry.)

December 31st, 2025, 21:31 UTC
1. Phase 7.1: Removed title_author_hash from canonical books schema definitions (new installs/upgrades wonâ€™t create/expect it).
2. Phase 7.2: Added versioned migration (DB version bump) to drop title_author_hash column/index safely and idempotently.
3. Phase 7.3: Removed remaining code paths relying on title_author_hash and deleted temporary Phase 6 admin hook.

December 31st, 2025, 22:41 UTC
1. Phase 8.1: Removed legacy author column reads/writes and routed author display, cover search, and confirm matching through canonical author pivots.
2. Phase 8.2: Updated wp_politeia_books schema definitions to drop author and normalized_author from new installs.
3. Phase 8.3: Added versioned migration (DB version 1.8.0) to drop legacy author columns safely and idempotently.

December 31st, 2025, 23:38 UTC
1. Phase 9.1: Defined title-only slug rule (+year on collision), added alias slug table support, and wired redirects to canonical slugs.
2. Phase 9.2: Added non-destructive slug migration to backfill new slugs and store legacy slugs as aliases (DB version 1.9.0).
3. Phase 9.3-9.5: Enforced predictable slug uniqueness, removed author-based slug logic, and unified slug generation across confirm and single-add flows.

January 1st, 2026, 11:24 UTC
1. Fixed normalized_title normalization to use canonical lowercasing + cleanup in new inserts/updates.
2. Unified normalization helpers across candidate queue, inline confirm updates, and canonical insert paths.
3. Routed book-detection normalization through the shared canonical normalizer for consistent identity comparisons.

January 1st, 2026, 12:13 UTC
1. Added canonical title autocomplete endpoint using normalized_title and localized its nonce/URL to the add-book script.
2. Updated add-book autocomplete to query canonical matches first and fall back to external providers only when empty.
3. Labeled canonical suggestions distinctly while preserving existing dropdown behavior.

January 1st, 2026, 12:37 UTC
1. Expanded title autocomplete to include canonical + Google Books + Open Library results (one per source when available).
2. Returned canonical authors via pivot lookup to support consistent dropdown metadata.
3. Restyled dropdown items to show title + source label with separate author/year lines.

January 1st, 2026, 13:14 UTC
1. Hid author input and hint when authors are set, exposing an Edit button to reveal and prefill the input.
2. Adjusted author Edit button styling and behavior for safer author edits.
3. Removed source labels from autocomplete titles while preserving source order logic.

January 1st, 2026, 18:25 UTC
1. Added ISBN field to the add-book form, wired it through candidate creation, and enabled autofill from external sources.
2. Extended autocomplete to pull ISBN and pages from Google Books/Open Library and display as chips on selection.
3. Added fallback detail fetches to enrich ISBN/pages when initial search results are missing fields.

January 1st, 2026, 18:42 UTC
1. Added cover autofill from Google Books/Open Library to the add-book preview image.
2. Adjusted cover preview sizing to keep width fixed and allow height to adapt to remote covers.

January 1st, 2026, 20:56 UTC
1. Added canonical ISBN storage to wp_politeia_books with installer + migration updates.
2. Wired ISBN persistence through confirm and add-book flows with normalization safeguards.
3. Guarded ISBN writes in the ChatGPT DB handler when the column is present.

January 1st, 2026, 21:08 UTC
1. Attempted multiple fixes to ISBN-based autocomplete selection; ISBN suggestions still do not populate Title/Author/Year/Pages/Cover fields.
2. Deferred final resolution and documented follow-up needed.

------

TO DO:

December 31st
1. Add detailed session entries as new development tasks are completed.
2. Add a user-facing button to export personal book records to a standardized CSV download.
3. Fix ISBN autocomplete selection so choosing a suggestion populates Title/Author/Year/Pages/Cover reliably.
